# \<Simple Malware Transmission Protocol>

Author: *Royce*

>Difficulty: \<hard> 
Bro this isn't pwn. No need to care about security features, but here they are anyways. 
- [O] No Stack Canaries
- [x] NX
- [X] PIE
- [X] No RPATH
- [X] No Runpath
- [X] No Symbols

Flag: `magpieCTF{wH03v3nUs3s3M41Ln0wad4ys}`

## Backstory

"Malware has been found on Christina Krypto's computer, it seems that it was uploaded around the time of her death. Investigate the binary to see if you can find something in relation to the perpetuator. It must be Kaylined, the rest of the suspects don't seem capable of making something of this sort. Analysts have also noted that the malware seems to somehow be communicating with something..."

In reality, the file was actually made by Edward Cors in an attempt to steal Christina’s secret from her computer. If the player looks at the SMTP’s server certificate, they will find that it was issued by the NYPD. 

## Intended Solve
The C Binary does NOT verify the SMTP server's certifiate. A user can MITM proxy the binary and retrieve the credentials to login to the SMTP server. Once logged in, the player needs to send an email successfully and the server will reply with the flag.
Alternatively, the players can solve the challenge by reverse engineering the C binary and retrieving the credentials. This is not the intended way of solving because this is a pain to do. I do hope 

## Build Instructions
Build using the makefile. 
SMTP Library at https://github.com/somnisoft/smtp-client using CC0 License. You will need SSLDev installed to compile.

BEFORE RELEASE:
 - Omit the SMTP_DEBUG in the header
 - Change and build the password. Make sure it is correct
 - Omit all printf and debug statements

## Handouts
- notavirus

## Other
*SMTP Server binary is NOT Included in this folder. It is too much of a pain to upload to github.*
